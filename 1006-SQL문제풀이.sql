use class;
select * from 교과목;

insert into student values 
	(1122, "정소화", "공통과정", 2020),
	(1343, "원희석", "공통과정", 2020),
	(2130, "김선우", "소프트웨어개발과", 2019),
	(2225, "김철수", "소프트웨어개발과", 2019),
	(2330, "채광주", "임베디드소프트웨어과", 2019),
	(3121, "성원용", "소프트웨어개발과", 2018),
	(3232, "오형준", "소프트웨어개발과", 2017),
	(3424, "고명석", "정보보안과", 2018);

insert into 교과목 values
	("C111", "자료구조", "공통과정", 7),
	("C123", "프로그래밍", "공통과정", 7),
	("C234", "데이터베이스", "소프트웨어개발과", 3),
	("C356", "운영체제", "소프트웨어개발과", 3),
	("C366", "네트워크", "정보보안과", 3),
	("C412", "컴퓨터구조", "임베디드소프트웨어과", 2);
    
insert into 이수 values
	(1122, "C111", 100, 80),
	(1122, "C123", 93, 96),
	(1122, "C234", 52, 47),
	(1122, "C356", 60, 50),
	(1122, "C366", 86, 68),
	(1122, "C412", 100, 59),
	(1343, "C111", 70, 100),
	(1343, "C234", 66, 56),
	(2130, "C234", 72, 82),
	(2225, "C234", 46, 64),
	(2225, "C356", 65, 89),
	(2330, "C234", 100, 97),
	(3121, "C234", 56, 70),
	(3121, "C366", 88, 50),
	(3121, "C412", 91, 73),
	(3232, "C111", 76, 38),
	(3232, "C234", 80, 90),
	(3424, "C234", 100, 95),
	(3424, "C356", 98, 79);
    
#1번
select substr(교과목명,1,2) as 두글자 from 교과목;
#2번
select substr(교과목명,2,3) as 세글자 from 교과목;
#3번
select length(교과목명)/3,교과목명 from 교과목;
#4번
select 교과목명, instr(교과목명,'조') from 교과목;
#5번
select replace(교과목번호,'C','P') from 교과목;
#6번
select lpad(교과목명,10,'*') from 교과목;
#7번
select 기말성적,repeat('■',TRUNCATE(기말성적/10,0)) from 이수;


#2-1
select 학번, if(학번%2 = 0,'짝수','홀수') from 이수;
#2-2
select 기말성적,
		case when (truncate(기말성적/10,0)) = 9 then 'A'
			when (truncate(기말성적/10,0)) = 8 then 'B'
            when (truncate(기말성적/10,0)) = 7 then 'C'
            when (truncate(기말성적/10,0)) = 6 then 'D'
			else 'E' end as 기말성적
from 이수;
#3-1
select (중간성적+기말성적)/2 as 평균,ntile(5) over (order by (중간성적+기말성적)/2 desc) as 등급 from 이수;

select 학번,sum(중간성적),sum(기말성적) from 이수 group by 학번 with rollup;
